# AgeOfWarPython — фичи и задачи

## Где “хранятся” фичи и задачи

- **Фичи (Feature / Epic)** и **задачи (Task)** хранятся прямо в этом файле `TASKS.md` в виде списка.
- Вы берёте в работу **номер фичи** целиком (например `F-03`) или **конкретный номер задачи** (например `T-03.02`).

## Правила

- **Task**: 1–4 часа работы, один понятный результат.
- У каждого Task есть **DoD** (Definition of Done) — что считается готовым.
- Если берёте Feature целиком — берёте все её Task и делаете одной веткой/PR (или несколькими, если договорились).

---

## F-01 Архитектура проекта (DONE)

Каркас уже собран: 2 сцены (`menu`, `game`), системы/сущности, `global_events.py`, `paths.py`.

### T-01.01 Проверка структуры пакетов (DONE)

- **Сделать**: убедиться, что весь актуальный код игры в `game/`.
- **DoD**: `python main.py` запускается и открывает меню.

### T-01.02 Единые пути в `paths.py` (DONE)

- **Сделать**: новые папки ассетов добавлять в `game/paths.py`, не хардкодить `"assets/..."`.
- **DoD**: новые изменения не добавляют строковых путей в произвольных местах.

---

## F-02 Глобальные события (SpritePro EventBus)

Цель: единый стиль событий через `s.events` + имена/типизация в `game/global_events.py`.

### T-02.01 Добавить 2–3 события “под игру”

- **Сделать**: добавить новые события в `GameEvents` + payload dataclass (если нужно).
- **DoD**: минимум 1 событие отправляется (`send`) и минимум 1 событие слушается (`connect`) в другой системе, с `disconnect` в `on_exit`.

### T-02.02 Привести нейминг событий к одному стилю

- **Сделать**: использовать `aow.<подсистема>.<действие>` и ключ `data` для payload.
- **DoD**: в коде нет “случайных” имён событий без `aow.` и без `GameEvents`.

---

## F-03 Экономика (золото)

Цель: золото копится по времени, тратится на спавн, UI всегда отражает актуальные значения.

### T-03.01 Вынести параметры экономики в конфиг

- **Сделать**: стартовое золото/доход/цены юнитов вынести в `config.py` (или отдельный конфиг домена).
- **DoD**: баланс меняется без правки систем.

### T-03.02 Трата золота на спавн

- **Сделать**: перед спавном проверять стоимость и списывать золото.
- **DoD**: при недостатке золота юнит не появляется; UI/лог показывают причину.

### T-03.03 События экономики для UI

- **Сделать**: `EconomySystem` отправляет `GameEvents.GOLD_CHANGED`, `UISystem` обновляет HUD.
- **DoD**: HUD меняется при начислении/тратах.

---

## F-04 HUD / UI

Цель: базовый HUD и минимум кнопок для управления прототипом.

### T-04.01 Панель HP баз

- **Сделать**: вывести HP базы игрока и врага в HUD.
- **DoD**: значения отображаются и обновляются при изменении HP.

### T-04.02 Кнопки спавна и подсказки управления

- **Сделать**: кнопки спавна (игрок/враг), плюс подсказка горячих клавиш.
- **DoD**: UI кликается, события уходят в спавн, ничего не создаётся напрямую из UI.

---

## F-05 Лейны (линии боя)

Цель: 1–3 полосы (lane), у юнитов есть lane, спавн/бой работают внутри lane.

### T-05.01 Модель lane

- **Сделать**: завести `lane` в `SpawnRequested` и хранить lane у юнита.
- **DoD**: `SpawnRequested(lane=...)` приводит к корректной Y-позиции.

### T-05.02 Визуализация lane (для дебага)

- **Сделать**: нарисовать линии/метки lane (примитивами/текстом).
- **DoD**: видно где lane 0/1/2.

---

## F-06 Спавн/юниты (очередь)

Цель: очередь спавна и кулдаун, чтобы спам не создавал сотни объектов за кадр.

### T-06.01 Очередь спавна

- **Сделать**: `SpawnSystem` принимает запросы и создаёт юнитов по таймеру.
- **DoD**: 3 запроса → 3 юнита появляются с задержкой, FPS не падает.

### T-06.02 Ограничение числа юнитов

- **Сделать**: лимит по количеству активных юнитов на сторону/на lane.
- **DoD**: при превышении лимита запрос отклоняется/ставится в очередь с понятным сообщением.

---

## F-07 Бой (минимальная механика)

Цель: юниты идут вперёд, находят цель, наносят урон по кулдауну, умирают.

### T-07.01 Движение вперёд

- **Сделать**: юниты игрока идут вправо, врага — влево (учитывая dt).
- **DoD**: юниты двигаются стабильно при разных FPS.

### T-07.02 Поиск цели

- **Сделать**: в `BattleSystem` выбрать ближайшую цель в своём lane.
- **DoD**: метод `find_target` возвращает цель или `None`.

### T-07.03 Урон по таймеру (melee)

- **Сделать**: кулдаун атак и применение урона.
- **DoD**: при сближении HP уменьшается, юнит умирает и исчезает.

### T-07.04 Урон по базе

- **Сделать**: если врагов нет и юнит дошёл до базы — бьёт базу.
- **DoD**: база теряет HP и может быть разрушена.

---

## F-08 Эпохи и апгрейды (Age of War core)

Цель: простая система прогресса эпох и апгрейдов.

### T-08.01 Модель эпох и требований

- **Сделать**: определить правила перехода эпох (стоимость, условия).
- **DoD**: можно переключить эпоху через одну кнопку/команду (пока без баланса).

### T-08.02 Набор юнитов по эпохам

- **Сделать**: связать доступные `UnitType`/префабы статов с эпохой.
- **DoD**: после апгрейда появляются новые опции спавна.

---

## F-09 Ассеты (арт/аудио)

Цель: заменить примитивы на реальные спрайты и добавить базовые звуки.

### T-09.01 Подключить изображения

- **Сделать**: положить изображения в `assets/images/` и заменить пустые спрайты на пути.
- **DoD**: игра запускается и корректно отображает спрайты.

### T-09.02 SFX на клик/спавн

- **Сделать**: добавить звук клика/спавна (через `spritePro.audio_manager`).
- **DoD**: звук проигрывается; отсутствие файла не валит игру.
